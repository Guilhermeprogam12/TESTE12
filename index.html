<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teste *__*</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      text-align: center;
    }
    h1 {
      color: #333;
      margin-bottom: 2rem;
    }
    .buttons-container {
      display: flex;
      gap: 2rem;
      position: relative;
    }
    .button {
      padding: 15px 30px;
      font-size: 1.2rem;
      font-weight: bold;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: transform 0.2s ease-out, background-color 0.3s;
      position: relative;
      z-index: 10;
    }
    #button1 {
      background-color: #2196F3;
      color: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    #button2 {
      background-color: #F44336;
      color: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .button:hover {
      transform: scale(1.05);
    }
    .input-container {
      margin-bottom: 1rem;
    }
    #name-input, #sexo-select {
      padding: 10px;
      font-size: 1rem;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin: 5px;
    }
    #scoreboard {
      margin-top: 3rem;
      width: 80%;
      max-width: 700px;
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
    #scoreboard h2 {
      margin-top: 0;
      color: #555;
    }
    #scoreboard table {
      width: 100%;
      border-collapse: collapse;
    }
    #scoreboard th, #scoreboard td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
    }
    #scoreboard th {
      background-color: #f2f2f2;
      text-align: left;
      font-weight: bold;
    }
    @media (max-width: 600px) {
      .buttons-container {
        flex-direction: column;
        gap: 1rem;
      }
      #scoreboard {
        width: 95%;
      }
    }
  </style>
</head>
<body>

  <div class="input-container">
    <input type="text" id="name-input" placeholder="Digite seu nome">
    <select id="sexo-select">
      <option value="">Selecione o sexo</option>
      <option value="Homem">Homem</option>
      <option value="Mulher">Mulher</option>
    </select>
  </div>

  <h1>Você é Hetero??</h1>
  
  <div class="buttons-container">
    <button id="button1" class="button">Sim</button>
    <button id="button2" class="button">Não</button>
  </div>

  <div id="scoreboard">
    <h2>Placar</h2>
    <p>Carregando placar...</p>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Sexo</th>
          <th>Resposta</th>
        </tr>
      </thead>
      <tbody id="scoreboard-body"></tbody>
    </table>
  </div>

  <script>
    const API_KEY = 'patrN3JMpr2BzKcFm.fa65192dbf4b45b7e54b22dc7f3fed27c691619d367ae9c36c44d59572e70a2b';
    const BASE_ID = 'app0C25Tln4mH86v2';
    const TABLE_NAME = 'tbloNOGsnvnlgcHrJ';

    const buttonYes = document.getElementById('button1');
    const buttonNo = document.getElementById('button2');
    const nameInput = document.getElementById('name-input');
    const sexoSelect = document.getElementById('sexo-select');
    const scoreboardBody = document.getElementById('scoreboard-body');

    // Buscar placar
    async function fetchScoreboard() {
      const url = `https://api.airtable.com/v0/${BASE_ID}/${TABLE_NAME}`;
      try {
        const response = await fetch(url, {
          method: 'GET',
          headers: { 'Authorization': `Bearer ${API_KEY}` }
        });
        if (!response.ok) throw new Error('Erro ao buscar dados: ' + response.statusText);
        const data = await response.json();
        
        scoreboardBody.innerHTML = '';
        if (data.records.length > 0) {
          data.records.forEach(record => {
            const nome = record.fields.nome;
            const sexo = record.fields.sexo;
            const estado = record.fields.estado;
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${nome || 'Sem nome'}</td>
              <td>${sexo || 'Não informado'}</td>
              <td>${estado || 'Sem resposta'}</td>
            `;
            scoreboardBody.appendChild(row);
          });
        } else {
          scoreboardBody.innerHTML = '<tr><td colspan="3">Nenhum registro encontrado.</td></tr>';
        }
      } catch (error) {
        console.error('Erro ao buscar placar:', error);
        scoreboardBody.innerHTML = '<tr><td colspan="3">Erro ao carregar o placar.</td></tr>';
      }
    }

    // Enviar dados
    function sendToAirtable(nome, sexo, estado) {
      const url = `https://api.airtable.com/v0/${BASE_ID}/${TABLE_NAME}`;
      fetch(url, {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${API_KEY}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          "records": [
            {
              "fields": { nome, sexo, estado }
            }
          ]
        })
      })
      .then(response => {
        if (!response.ok) throw new Error('Erro na requisição: ' + response.statusText);
        return response.json();
      })
      .then(() => fetchScoreboard())
      .catch(error => console.error('Erro ao enviar dados para o Airtable:', error));
    }

    // Botão "Não"
    function handleNoClick() {
      const nome = nameInput.value.trim();
      const sexo = sexoSelect.value;
      if (nome && sexo) {
        let estado = "";
        if (sexo === "Homem") {
          estado = "Viado";
        } else if (sexo === "Mulher") {
          estado = "Lésbica";
        }
        sendToAirtable(nome, sexo, estado);
        alert(`Parabéns! Agora você é ${estado}`);
      } else {
        alert('Digite seu nome e selecione o sexo antes de continuar.');
      }
    }

    // Botão "Sim"
    let yesLocked = false;
    function handleYesClick(){
      if(yesLocked) return;
      const nome = nameInput.value.trim();
      const sexo = sexoSelect.value;
      if(!nome || !sexo){ 
        alert('Digite seu nome e selecione o sexo antes de continuar.'); 
        return; 
      }
      yesLocked = true;
      let estado = "";
      if(sexo === "Homem"){
        estado = "Viado! Mentiroso";
      } else if(sexo === "Mulher"){
        estado = "Lésbica, Mentirosa";
      }
      sendToAirtable(nome, sexo, estado);
      alert('Não pode mentir!');
      setTimeout(()=> yesLocked = false, 800);
    }

    // Faz o botão "Sim" correr
    function moveButton(event) {
      const mouseX = event.clientX;
      const mouseY = event.clientY;
      const buttonRect = buttonYes.getBoundingClientRect();
      const buttonCenterX = buttonRect.left + buttonRect.width / 2;
      const buttonCenterY = buttonRect.top + buttonRect.height / 2;
      const distanceX = mouseX - buttonCenterX;
      const distanceY = mouseY - buttonCenterY;
      const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY);
      const repelDistance = 200;
      if (distance < repelDistance) {
        const angle = Math.atan2(distanceY, distanceX);
        const moveDistance = (repelDistance - distance) / 2;
        const newX = -Math.cos(angle) * moveDistance;
        const newY = -Math.sin(angle) * moveDistance;
        buttonYes.style.transform = `translate(${newX}px, ${newY}px)`;
      } else {
        buttonYes.style.transform = `translate(0, 0)`;
      }
    }

    // Eventos
    buttonNo.addEventListener('click', handleNoClick);
    buttonYes.addEventListener('click', handleYesClick);
    document.addEventListener('mousemove', moveButton);

    // Carregar placar
    fetchScoreboard();
  </script>
</body>
</html>
